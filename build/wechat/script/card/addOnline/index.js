!function t(e,a,r){function o(l,i){if(!a[l]){if(!e[l]){var n="function"==typeof require&&require;if(!i&&n)return n(l,!0);if(d)return d(l,!0);throw new Error("Cannot find module '"+l+"'")}var s=a[l]={exports:{}};e[l][0].call(s.exports,function(t){var a=e[l][1][t];return o(a?a:t)},s,s.exports,t,e,a,r)}return a[l].exports}for(var d="function"==typeof require&&require,l=0;l<r.length;l++)o(r[l]);return o}({1:[function(t,e,a){function r(){$.ajax({url:"/familyMember/queryMemberInfo.htm",type:"POST",data:{patientId:u},success:function(t){t.code?promptUtil.alert({content:t.message,type:"alert"}):o(t)}})}function o(t){$('[data-role="name"]').append(t.pName),$('[data-role="idCard"]').append(t.pCertNo),$('[data-role="hospName"]').append(n)}function d(){var t=!0,e=$.trim($('[data-role="phone"]').val()),a=$.trim($('[data-role="validCode"]').val());return t&&!e.length&&(t=!1),t&&!a.length&&(t=!1),t}function l(){var t=!0,e=$.trim($('[data-role="phone"]').val()),a=$.trim($('[data-role="validCode"]').val());return t&&!taoguKit.valid.mobile(e)&&(promptUtil.toast("输入手机格式有误，请输入正确手机号"),t=!1),t&&!taoguKit.valid.msgCode(a)&&(promptUtil.toast("输入验证码格式有误"),t=!1),t}var i=TaoGu.APP.Utility,n=i.Network.queryString("hospName"),s=i.Network.queryString("hospId"),u=i.Network.queryString("patientId"),p=(i.Network.queryString("backto"),""),c=!1,m=!1,v=!1,f=function(t,e){if(v)return!1;v=!0;var a=t,e=e||[],r=e,o=e.val(),d={reset:function(){v=!1,t=a,r.val(o),e.removeClass("btn_code_disabled"),e.removeAttr("disabled").removeAttr("style")},carryOut:function(){t<=1?d.reset():(--t,e.val("重新获取"+t),e.addClass("btn_code_disabled"),e.attr("disabled",!0).css("color","#484747"),setTimeout(d.carryOut,1e3))}};d.carryOut()};$('[data-role="phone"]').add($('[data-role="validCode"]')).on("input",function(t){if(m)return!1;d();d()?$('[data-role="submit"]').removeClass("disabled").removeAttr("disabled"):$('[data-role="submit"]').addClass("disabled").attr("disabled",!0)}),$('[data-role="validCodeBtn"]').on("tap",function(){if(m)return!1;var t=$.trim($('[data-role="phone"]').val());return taoguKit.valid.mobile(t)?!c&&(c=!0,void $.ajax({url:"/security/smscoderequest.htm",type:"POST",data:{phoneNo:t,type:7,patientId:u},success:function(t){t.code?promptUtil.alert({content:t.message,type:"alert"}):($('[data-role="validCode"]').removeAttr("disabled").removeClass("disabled"),f(60,$('[data-role="validCodeBtn"]')))},complete:function(){c=!1}})):(promptUtil.toast("输入手机格式有误，请输入正确手机号"),!1)}),$('[data-role="go"]').on("click",function(t){$('[data-role="mask"]').css("display","none"),$('[data-role="hint"]').css("display","none")}),$('[data-role="submit"]').on("click",function(t){if(m)return!1;var e=$.trim($('[data-role="phone"]').val()),a=$.trim($('[data-role="validCode"]').val()),r=taoguKit.valid.getMsgCode(e,a);return r.ret?void(l()&&$.ajax({url:"/treatcard/addCardOnline.htm",type:"POST",data:{hospId:s,memberId:u},success:function(t){t.code?promptUtil.alert({content:t.message,type:"alert"}):(p=t.patientId,$('[data-role="mask"]').show(),$('[data-role="pNo"]').text("您的诊疗卡号为:"+t.medicalCardNo),$('[data-role="hint"]').css("display","block"),$('[data-role="submit"]').attr("disabled","disabled"),$('[data-role="submit"]').addClass("disabled"),$('[data-role="phone"]').attr("readonly",!0),$('[data-role="validCode"]').attr("readonly",!0),$('[data-role="validCodeBtn"]').addClass("btn_code_disabled")),m=!0}})):(promptUtil.alert({content:r.message,type:"alert"}),!1)}),$('[data-role="validCode"]').attr("disabled",!0).addClass("disabled").val(""),r()},{}]},{},[1]);