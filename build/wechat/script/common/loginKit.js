!function t(i,e,s){function n(a,l){if(!e[a]){if(!i[a]){var r="function"==typeof require&&require;if(!l&&r)return r(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var d=e[a]={exports:{}};i[a][0].call(d.exports,function(t){var e=i[a][1][t];return n(e?e:t)},d,d.exports,t,i,e,s)}return e[a].exports}for(var o="function"==typeof require&&require,a=0;a<s.length;a++)n(s[a]);return n}({1:[function(t,i,e){var s={init:function(){$(document).bind("loginKit_login",function(t,i){i=i||{},this.compose(i)}.bind(this))},compose:function(t){var i=t.tel||null,e=t.hasClose||!1;return this.loaded?(this.$err.empty(),this.$fade.css("display","block"),this.$top.css("display","block"),this.$tel.val(i||""),this.$pw.val(""),!1):($("body").append(this.htmlBuilder(e)),setTimeout(function(){this.bindEvt(t)}.bind(this),300),void(this.loaded=!0))},htmlBuilder:function(t){var i=($("body").get(0),['<div id="loginKitPop" class="login_popup" style="display:block;">',"<h1>登录",t?'<i><img src="/wechat/images/close.png" class="close_icon" data-login="close"></i>':"","</h1>",'<ul class="inp_list_n">',"<li>",'<input type="text" data-login="tel" placeholder="请输入注册时的手机号" value="" />',"</li>","<li>",'<input type="password" data-login="pw" placeholder="请输入注册时设置的密码" value="" />',"</li>","</ul>",'<div class="forget_password_n"><a data-login="forgot" href="/wechat/html/sys/forgot/">忘记密码？</a></div>','<div data-login="err" style="text-align:center;color:#f00;height:1em;"></div>','<section class="but_div2_n">','<input type="button" value="登录" data-login="btn" class="disabled" disabled />',"</section>",'<div class="go_register_n">还没有账户，<a href="/wechat/html/sys/reg/" data-login="reg">立即注册</a></div>',"</div>",'<div data-login="patients" class="pop_patients" style="z-index:3000;display:none;">',"<h2>选择就诊人</h2>",'<ul data-login="patientlist"></ul>',"</div>",'<div id="loginKitFade" class="black_overlay" style="display:block;"></div>']);return i.join("")},bindEvt:function(t){var i=t.tel||null;t.hasClose||!1;this.$top=$("#loginKitPop"),this.$fade=$("#loginKitFade"),this.$patients=$('[data-login="patients"]'),this.$tel=$('[data-login="tel"]',this.$top),this.$pw=$('[data-login="pw"]',this.$top),this.$forgot=$('[data-login="forgot"]',this.$top),this.$btn=$('[data-login="btn"]',this.$top),this.$reg=$('[data-login="reg"]',this.$top),this.$close=$('[data-login="close"]',this.$top),this.$err=$('[data-login="err"]',this.$top).empty(),this.$tel.val(i||""),this.$pw.val(""),this.$forgot.attr("href",this.$forgot.attr("href")+"?backto="+encodeURIComponent(location.href)),this.$reg.attr("href",this.$reg.attr("href")+"?backto="+encodeURIComponent(location.href)),this.$fade.on("touchmove",function(t){return t.preventDefault(),t.stopPropagation(),!1}),this.$btn.on("tap",function(t){this.$err.empty();var i="",e=$.trim(this.$tel.val()),s=$.trim(this.$pw.val());return i||taoguKit.valid.mobile(e)||(i="请输入正确的手机号码"),i||taoguKit.valid.passwordFormat(s)||(i="请输入正确的密码"),i?(this.$err.text(i),!1):void this.subForm({phoneNo:e,password:window.MD5(s)})}.bind(this)),this.$patients.on("click",'[data-login="pNameList"]',function(t){var i=$(t.target).data("id");$(t.target).data("name");return!!i&&void $.ajax({url:"/security/savePatientId.htm",type:"POST",data:{patientId:i},success:function(t){},complete:function(){location.reload(!0)}})}),this.$close.on("click",function(t){setTimeout(function(){this.$top.css("display","none"),this.$fade.css("display","none")}.bind(this),500)}.bind(this)),this.$tel.add(this.$pw).on("input",function(t){this.$err.empty();var i=$.trim(this.$tel.val()),e=$.trim(this.$pw.val());i.length&&e.length?this.$btn.removeClass("disabled").removeAttr("disabled"):this.$btn.addClass("disabled").attr("disabled",!0)}.bind(this))},subForm:function(t){return!this.lockSubmit&&(this.lockSubmit=!0,void $.ajax({url:"/security/login.htm",type:"POST",data:t,forbidLoginHook:!0,success:function(t){t.code?this.$err.text(t.message):(this.$top.css("display","none"),setTimeout(function(){this.fetchPatientList()}.bind(this),500))}.bind(this),complete:function(){this.lockSubmit=!1}.bind(this)}))},renderPatientList:function(t){var i="";$.each(t,function(t,e){i+="<li data-login='pNameList' data-id='"+e.tmPId+"' data-name="+e.pName+">"+e.pName+"</li>"}),$('[data-login="patientlist"]').html(i)},fetchPatientList:function(){$.ajax({url:"/familyMember/queryMyMembers.htm",type:"POST",success:function(t){t.code?(this.$fade.css("display","none"),promptUtil.alert({content:t.message,type:"alert"})):(this.$fade.css("display","block"),this.$patients.css("display","block"),this.renderPatientList(t.familflist))}.bind(this)})}};s.init()},{}]},{},[1]);