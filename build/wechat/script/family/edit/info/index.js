!function a(t,e,r){function n(o,l){if(!e[o]){if(!t[o]){var s="function"==typeof require&&require;if(!l&&s)return s(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var d=e[o]={exports:{}};t[o][0].call(d.exports,function(a){var e=t[o][1][a];return n(e?e:a)},d,d.exports,a,t,e,r)}return e[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)n(r[o]);return n}({1:[function(a,t,e){!function(){var a="",t=TaoGu.APP.Utility,e=t.Network.queryString("patientId"),r="/wechat/html/pCard/hospitalList/?patientId="+e+"&backto="+encodeURIComponent(location.href),n="/wechat/html/me/miCard/bind/?patientId="+e+"&backto="+encodeURIComponent(location.href),i=0,o=function(){var t={cardsCache:{},queryHospitalsNoCard:function(a){$.ajax({url:"/treatcard/queryHospitalsNoCard.htm ",type:"POST",data:{memberId:e},success:function(t){a(t)}})},renderCards:function(){var t=[],e=this.cardsCache;return e.siCardNo?(a=e.siCardNo,t.push(['<h2 class="hospital_tit" data-role="hospital_tit">医保卡信息</h2>','<ul class="medical_card_list" data-role="medical_card_list">','<li data-role="medicalCardshow" data-num="'+a+'">','<h4 class="color9c">医保卡号：</h4>',"<p>"+a+"</p>",'<a data-role="relieveSiCardNo" href="javascript:;">解除</a>',"</li>","</ul>"].join(""))):t.push(['<h2 class="hospital_tit">完善成员信息</h2>','<ul class="hospital_list">','<li class="b_t"><a href="'+n+'">绑定医保卡</a></li>',e.tcardlist.length?"":'<li><a data-role="addPcard" href="javascript:;" data-href="'+r+'">添加诊疗卡</a></li>',"</ul>"].join("")),e.tcardlist.length?t.push(['<div class="add_card">',"<h3>诊疗卡信息</h3>",'<a data-role="addPcard" href="javascript:;" data-href="'+r+'">添加诊疗卡</a>',"</div>",'<ul class="medical_card_list" style="">',function(){for(var a=[],t=0;t<e.tcardlist.length;t++)a.push(['<li data-view="tcardlistList" data-hospid="'+e.tcardlist[t].hospId+'" data-num="'+e.tcardlist[t].pCardNo+'">',"<h4>"+e.tcardlist[t].hospName+"</h4>","<p><span>诊疗卡号：</span>",e.tcardlist[t].pCardNo,1==e.tcardlist[t].pCardState?'<i class="normal">正常</i>':'<i class="abnormal">非正常</i>',"</p>",'<a data-role="relievetcardlist" href="javascript:;">解除</a>',"</li>"].join(""));return a.join("")}()].join("")):e.siCardNo&&t.push(['<h2 class="hospital_tit">完善成员信息</h2>','<ul class="hospital_list">','<li class="b_t"><a href="'+r+'">添加诊疗卡</a></li>',"</ul>"].join("")),t.join("")},renderPage:function(a){var r=a,n=["<li>","<label><span>姓&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;名：</span></label>",'<div class="inp_div">','<span class="span_con">'+r.pName+"</span>","</div>","</li>","<li>","<label><span>身&nbsp;份&nbsp;证&nbsp;：</span></label>",'<div class="inp_div">','<span class="span_con">'+r.pCertNo+"</span>","</div>","</li>",'<li data-role="ModifyTel" data-tel="'+r.phone+'">',"<label><span>手&nbsp;机&nbsp;号&nbsp;：</span></label>",'<div class="inp_div">',1==r.mineFlag?'<span class="span_con">'+r.phone+"</span>":'<a href="javascript:;">'+r.phone+"</a>","</div>"," </li>","<li>","<label><span>常用地址：</span></label>",'<div class="inp_div">','<a href="/wechat/html/me/addr/?addr='+encodeURIComponent(r.pAddr)+"&memberId="+e+"&backto="+encodeURIComponent(location.href)+'">'+r.pAddr+"</a>","</div>","</li>"].join("");$('[data-role="baseInfo"]').html(n);var i=t.renderCards(t.cardsCache=r);$('[data-role="appendBox"]').html(i)},fetchPage:function(){$.ajax({url:"/familyMember/queryMemberInfo.htm",type:"POST",data:{patientId:e},success:function(a){a.code?promptUtil.alert({content:a.message,type:"alert"}):(i=a.mineFlag,t.renderPage(a))}})},relieveSiCardNo:function(a){$.ajax({url:"/user/unBindSICardFaminly.htm",type:"POST",data:{memberId:e},success:function(a){a.code?promptUtil.alert({content:a.message,type:"alert"}):(t.cardsCache.siCardNo="",$('[data-role="appendBox"]').html(t.renderCards()))}})},relievetcardlist:function(a,t){$.ajax({url:"/treatcard/deleteMemberTreateCard.htm",type:"POST",data:{hospId:t,memberId:e},success:function(a){a.code?promptUtil.alert({content:a.message,type:"alert"}):location.reload()}})},deletePatient:function(){$.ajax({url:"/familyMember/deleteMember.htm",type:"POST",data:{memberId:e},success:function(a){a.code?promptUtil.alert({content:a.message,type:"alert"}):location.href="/wechat/html/family/list/"}})}};return{init:function(){t.fetchPage(),this.bindEvent()},bindEvent:function(){$('[data-role="baseInfo"]').on("tap",'[data-role="ModifyTel"]',function(){if(1!=i)return location.href="/wechat/html/family/edit/phone/?phone="+$(this).closest('[data-role="ModifyTel"]').attr("data-tel")+"&patientId="+e,!1}),$("body").on("tap",'[data-role="relieveSiCardNo"]',function(){var a=this;promptUtil.alert({type:"confirm",confirm:"确认",content:"确认要解绑医保卡？",confirmFunc:function(){t.relieveSiCardNo($(a).parent('[data-role="medicalCardshow"]').attr("data-num"))}})}),$("body").on("tap",'[data-role="relievetcardlist"]',function(a){var e=this;promptUtil.alert({type:"confirm",confirm:"确认",content:"确认要解绑此诊疗卡？",confirmFunc:function(){var a=$(e).parent('[data-view="tcardlistList"]');t.relievetcardlist(a.attr("data-num"),a.attr("data-hospid"))}})}),$("body").on("tap",'[data-role="addPcard"]',function(a){var e=$(a.target);t.queryHospitalsNoCard(function(a){a.code?promptUtil.alert({content:"已添加完所有医院",type:"alert"}):location.href=e.data("href")})}),$('[data-role="buttonBox"]').on("tap",function(){return 1==i?(promptUtil.alert({content:"不允许删除本人信息",type:"alert"}),!1):void promptUtil.alert({type:"confirm",confirm:"确认",content:"确定要删除此家庭成员？",confirmFunc:function(){t.deletePatient()}})})}}};o().init()}()},{}]},{},[1]);