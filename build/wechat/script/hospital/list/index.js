!function t(a,e,o){function n(i,r){if(!e[i]){if(!a[i]){var d="function"==typeof require&&require;if(!r&&d)return d(i,!0);if(s)return s(i,!0);throw new Error("Cannot find module '"+i+"'")}var c=e[i]={exports:{}};a[i][0].call(c.exports,function(t){var e=a[i][1][t];return n(e?e:t)},c,c.exports,t,a,e,o)}return e[i].exports}for(var s="function"==typeof require&&require,i=0;i<o.length;i++)n(o[i]);return n}({1:[function(t,a,e){var o=function(){var t=20,a=0,e=TaoGu.APP.Utility,o=e.Network.queryString("patientId")||"",n=$('[data-role="input"]').val(""),s=$('[data-role="cancel"]'),i=$('[data-role="clsearBtn"]'),r=$('[data-role="hospList"]'),d=$('[data-role="no_his_record"]'),c=$('[data-role="record"]'),l=$('[data-role="doctorList"]'),p={isLogin:function(){$.ajax({url:"/user/queryUserInfo.htm",type:"POST",forbidLoginHook:!0,success:function(t){1e3==t.code&&$(document).trigger("loginKit_login"),t.code||(o=t.patientId)}})},fetchData:function(a,e){$.ajax({url:"/hospital/queryHospitalList.htm",type:"POST",data:{count:t,start:a*t},success:function(t){t.code?1500==t.code&&(e([]),d.removeClass("none")):(d.addClass("none"),e(t.list))}})},buildDataFunc:function(t,a){var e=[];if(t)return $.each(t,function(t,a){e.push(['<div class="hos_list_cont" data-role="hos_list_cont" data-hospId="'+a.hospId+'" data-part="'+a.havePartFlag+'" data-hospName="'+a.hospName+'">','<span class="list_cont_pic" data-role="list_cont_pic"><img src="/common/image/'+a.imageId+'.htm" width="128" height="127"/><i>'+(a.orgMiFlag?'<img src="/wechat/images/dd_icon.png">':"")+"</i></span>",'<div class="list_cont_text" data-role="list_cont_text">',"<h1>"+a.hospName+'<span class="fr '+(a.havaTreatCard?"orange_btn_s":"")+'" style="'+(a.havaTreatCard?"":"display:none;")+'">诊疗卡</span></h1>',"<h2>"+(a.hospTierName?a.hospTierName+" | ":"")+(a.hospCatName?a.hospCatName:"")+"</h2>","<p>"+(a.hospMajorDet?a.hospMajorDet:"")+"</p>","</div></div>"].join(""))}),e.join("")},buildList:function(){taoguKit.scrollLoad({wrapper:r,fetchDataFunc:this.fetchData,buildDataFunc:this.buildDataFunc,pageSize:t,currPage:a})},renderRecord:function(t){$('[data-record="ul"]').remove();var a=[];a.push('<ul data-record="ul"><li class="his_record_title">历史搜索</li>'),$.each(t,function(e,o){a.push(['<li data-role="history" data-name="'+t[e]+'"><a href="javascript:;">'+t[e]+"</a></li>"].join(""))}),a.push('<li class="his_record_cen" data-role="clearRecord"><a href="javascript:;">清空搜索记录</a></li></ul>'),c.html(a.join("")).css("margin-top",$(".pf").height()+"px")},getRecord:function(){$.ajax({url:"/doctor/querySearchHistory.htm",type:"POST",data:{historyType:10,wxTmpId:loginUtil.getWxOpenId()||""},success:function(t){t.code||p.renderRecord(t.resList)}})},clearRecord:function(){$.ajax({url:"/doctor/deleteSearchHistory.htm",data:{historyType:10,wxTmpId:loginUtil.getWxOpenId()||""},type:"POST",success:function(t){t.code||$(['data-record="ul"']).remove()}})},buildListDrList:function(){function e(a,e){$.ajax({url:"/doctor/queryDoctorList.htm",type:"POST",data:{doctorName:s,wxTmpId:loginUtil.getWxOpenId()||"",start:a*t,count:t},success:function(t){e(t.code?[]:t.list),1500!=t.code||a||d.removeClass("none"),1500==t.code&&a&&$('[data-role="doctorList"]').append('<h2 style="text-align:center line-height:40px">加载完毕</h2>')},error:function(){e([])}})}function o(t,a){0!=a||t&&t.length?d.addClass("none"):d.removeClass("none");var e=[];return $.each(t,function(t,a){e.push(['<div class="my_con" data-role="doctor" data-doctorid="'+a.drId+'" data-deptid="'+a.deptId+'" data-hospid="'+a.hospId+'" data-hospname="'+a.hospName+'" data-deptname="'+a.deptName+'">','<div class="my_con_pic"><img src="/common/image/'+a.imageId+'.htm"  width="138" height="137"></div>','<div class="my_con_text">','<p class="t_name">'+a.drName+'<span class="t_name_o">'+a.drLvlName+"</span></p>",'<p class="amount">预约量:'+a.regtAmt+" | 关注量:"+a.focusAmt+"</p>",' <p class="hos_cp">',function(){var t=[];return a.deptName&&t.push("<span>"+a.deptName+"</span>"),a.hospName&&t.push("<span>"+a.hospName+"</span>"),t.join(" | ")}(),"</p>","</div></div>"].join(""))}),e.join("")}var s=n.val();return!!$.trim(s).length&&(l.empty(),void taoguKit.scrollLoad({wrapper:l,fetchDataFunc:e,buildDataFunc:o,pageSize:t,currPage:a}))},bindEvt:function(){var t=null;n.on("focus",function(){$(this).parent().siblings(".city_but").show(),$(this).parent().addClass("mr"),r.hide(),c.show().removeClass("none"),s.removeClass("none"),l.addClass("none"),d.addClass("none"),p.getRecord()}),n.on("input",function(t){$(this).val()?i.show():i.hide()}),s.on("click",function(){$(this).siblings(".search_mr").removeClass("mr"),i.css("display","none"),$(this).siblings(".pos_add").show(),r.show(),n.val(""),$('[data-record="ul"]').remove(),l.addClass("none").empty(),s.addClass("none"),d.addClass("none"),c.addClass("none")}),i.on("tap",function(){t&&clearTimeout(t),n.val("").focus(),c.removeClass("none"),l.addClass("none"),d.addClass("none"),$(this).hide(),p.getRecord()}),$("body").on("tap",'[data-role="history"]',function(){var t=$(this).data("name");n.val(t),i.show(),c.addClass("none"),l.removeClass("none"),p.buildListDrList()}),n.on("change propertychange",function(){var a=n.val();return 0==a.length?(l.addClass("none"),d.addClass("none"),c.removeClass("none"),p.getRecord(),!1):(c.addClass("none"),l.removeClass("none"),t&&clearTimeout(t),void(t=setTimeout(function(){p.buildListDrList()},300)))}),$("body").on("tap",'[data-role="doctor"]',function(){var t=$(this).data("doctorid"),a=$(this).data("hospid"),e=$(this).data("deptid"),o=$(this).data("hospname"),n=$(this).data("deptname");TaoGu.APP.Utility.Network.relocate("/wechat/html/doctor/home/?hospId="+a+"&hospName="+encodeURIComponent(o)+"&doctorId="+encodeURIComponent(t)+"&deptId="+encodeURIComponent(e)+"&deptName="+encodeURIComponent(n))}),$("body").on("tap",'[data-role="clearRecord"]',function(){$('[data-record="ul"]').remove(),p.clearRecord()}),$("body").on("tap",'[data-role="hos_list_cont"]',function(){var t=$(this).data("part"),a=$(this).data("hospid"),e=$(this).data("hospname");t?TaoGu.APP.Utility.Network.relocate("/wechat/html/hospital/area/list/?hospId="+a+"&hospName="+encodeURIComponent(e)+"&patientId="+o):TaoGu.APP.Utility.Network.relocate("/wechat/html/hospital/office/list/?hospId="+a+"&hospName="+encodeURIComponent(e)+"&patientId="+o)})}};return{init:function(){p.isLogin(),p.buildList(),p.bindEvt()}}}();o.init()},{}]},{},[1]);