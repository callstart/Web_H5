!function t(e,a,i){function r(n,l){if(!a[n]){if(!e[n]){var d="function"==typeof require&&require;if(!l&&d)return d(n,!0);if(o)return o(n,!0);throw new Error("Cannot find module '"+n+"'")}var s=a[n]={exports:{}};e[n][0].call(s.exports,function(t){var a=e[n][1][t];return r(a?a:t)},s,s.exports,t,e,a,i)}return a[n].exports}for(var o="function"==typeof require&&require,n=0;n<i.length;n++)r(i[n]);return r}({1:[function(t,e,a){var i=(TaoGu.APP.Utility,function(){var t=TaoGu.APP.Utility,e=(t.Bridge,t.Network.queryString("patientId")),a=(t.Network.queryString("backto"),!0),i={$phoneNo:$('[data-role="phoneNo"]'),$msg:$('[data-role="msg"]'),$btnMsg:$('[data-role="btnMsg"]'),$miCardNo:$('[data-role="miCardNo"]'),$btn:$('[data-role="btn"]'),btnDisabled:!0,preValid:function(){var t=!0,e=$.trim(this.$phoneNo.val()),a=$.trim(this.$msg.val()),i=$.trim(this.$miCardNo.val());return t&&!e.length&&(t=!1),t&&!taoguKit.valid.msgCode(a,e)&&(t=!1),t&&!i.length&&(t=!1),t},validAll:function(){var t=!0,e=$.trim(this.$phoneNo.val()),a=$.trim(this.$msg.val()),i=$.trim(this.$miCardNo.val());t&&!taoguKit.valid.mobile(e)&&(promptUtil.toast("手机号码格式不正确"),t=!1),t&&!taoguKit.valid.msgCode(a,e)&&(promptUtil.toast("短信格式不正确"),t=!1),t&&!taoguKit.valid.miCard(i)&&(promptUtil.toast("卡号格式不正确"),t=!1);var r=taoguKit.valid.getMsgCode(e,a);return t&&!r.ret&&(promptUtil.alert({content:r.message,type:"alert"}),t=!1),t},bindEvt:function(){$('[data-role="msg"]').attr("disabled",!0).addClass("disabled").val(""),this.$phoneNo.add(this.$msg).add(this.$miCardNo).on("input",function(t){var e=this;return!!a&&void(i.preValid&&(e.preValid()?(e.$btn.removeClass("disabled").removeAttr("disabled"),e.btnDisabled=!1):(e.$btn.addClass("disabled").attr("disabled",!0),e.btnDisabled=!0)))}.bind(this)),this.$btnMsg.on("click",function(t){return!!a&&(this.lock||!taoguKit.valid.mobile($.trim(this.$phoneNo.val()))?(promptUtil.toast("输入手机格式有误，请输入正确手机号"),!1):(this.lock=!0,void $.ajax({url:"/security/smscoderequest.htm",data:{phoneNo:this.$phoneNo.val(),type:5,patientId:e},type:"POST",success:function(e){if(e.code)return promptUtil.alert({content:e.message,type:"alert"}),!1;$('[data-role="msg"]').removeAttr("disabled").removeClass("disabled"),$(t.target).attr("disabled",!0).css("color","#484747");var a=59,i=$(t.target).val(),r=setInterval(function(){a>=1?$(t.target).val("重新获取 "+a--+"s"):(clearInterval(r),$(t.target).val(i).removeAttr("style").removeAttr("disabled"))}.bind(this),1e3)}.bind(this),complete:function(){this.lock=!1}.bind(this)})))}.bind(this)),this.$btn.on("click",function(e){return!!a&&void(i.validAll()&&$.ajax({url:"/user/bindSICard.htm",type:"POST",data:{memberId:t.Network.queryString("patientId"),SICardNo:this.$miCardNo.val()},success:function(t){t.code?promptUtil.alert({content:t.message,type:"alert"}):(promptUtil.alert({content:"绑定成功!",type:"alert"}),a=!1,$('[data-role="btn"]').attr("disabled","disabled"),$('[data-role="btn"]').addClass("disabled"),$('[data-role="phoneNo"]').attr("readonly",!0),$('[data-role="msg"]').attr("readonly",!0),$('[data-role="miCardNo"]').attr("readonly",!0))},complete:function(){this.lock=!1}.bind(this)}))}.bind(this))}};return{init:function(){i.bindEvt()}}}());i.init()},{}]},{},[1]);