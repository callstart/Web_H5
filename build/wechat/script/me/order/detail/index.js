!function e(t,a,r){function o(d,l){if(!a[d]){if(!t[d]){var i="function"==typeof require&&require;if(!l&&i)return i(d,!0);if(n)return n(d,!0);throw new Error("Cannot find module '"+d+"'")}var c=a[d]={exports:{}};t[d][0].call(c.exports,function(e){var a=t[d][1][e];return o(a?a:e)},c,c.exports,e,t,a,r)}return a[d].exports}for(var n="function"==typeof require&&require,d=0;d<r.length;d++)o(r[d]);return o}({1:[function(e,t,a){var r=function(){var e=TaoGu.APP.Utility,t=e.Network.queryString("regtOrdId"),a=(e.Network.queryString("payauto"),e.Network.queryString("cancelauto"),e.Network.queryString("doSubmit"),e.Network.queryString("cancleOrder"),""),r=!0,o=!0,n=!0,d={1:"上午",2:"下午",3:"全天",4:"中午",5:"晚上",6:"早上"},l={render:function(e){a=e.drType;var t=$('[data-panle="infos"]').text();for(var r in e)"regtTimeTypeId"==r&&(e[r]=d[e[r]]),t=t.replace(new RegExp("#"+r+"#","g"),e[r]||"");$('[data-role="infos"]').html(t),1==e.admSeqName?$('[data-role="regtSeq"]').removeClass("none"):$('[data-role="regtSrcLockId"]').removeClass("none"),$('[data-role="regtSrcLockId"]').text(),e.fullName&&$('[data-role="residual_time"]').removeClass("none"),$('[data-role="times"]').text("距离就诊日期还有"+function(){var t=e.regtDateTime-e.sysTime,a=t/864e5,r=Math.floor(t/1e3/60/60%24);if(t<=0)$("body").find('[data-role="times"]').addClass("none");else{if(a>0&&r>0)return $('[data-role="times"]').removeClass("none"),parseInt(a)+1+"天";$('[data-role="times"]').addClass("none")}}()),$('[data-role="btnbox"]').html(function(){var t=[];return t.push('<input type="button" value="再次预约" class="again" data-role="again" data-href="doctorId='+e.drId+"&deptId="+e.deptId+"&hospId="+e.hospId+"&hospName="+e.hospName+"&deptName="+e.deptName+"&patientId="+e.patientId+'"/>'),e.cancerOrder&&t.push('<input type="button" value="取消订单" class="cancel" data-role="cancel"/>'),e.doSubmit&&t.push('<input type="button" value="立即支付" class="payment" data-role="gopay"/>'),t.join("")}()),5!=e.regtStatId&&6!=e.regtStatId&&9!=e.regtStatId||$('[data-role="times"]').addClass("none"),9==e.regtStatId&&($('[data-role="timeRest"]').hide(),$('[data-role="gopay"]').hide()),5==e.regtStatId&&$('[data-role="hint]').html(e.hint).show();var o=e.payLockLongTime-e.sysTime;o>0?(setInterval(function(){o-=1e3,$('[data-role="timeRest"]').text("剩余支付时间"+function(){var e=Math.floor(o/1e3/60/60%24),t=Math.floor(o/1e3/60%60),a=Math.floor(o/1e3%60);return e>0?e+"时"+t+"分"+a+"秒":t>0?t+"分"+a+"秒":"00"!=a?a+"秒":a<=0?(location.reload(),"0秒"):void 0}())},1e3),o||$('[data-role="timeRest"]').hide()):(n=!1,$('[data-role="timeRest"]').hide()),this.bindEvt()},fetchData:function(e,a){$.ajax({url:"/order/queryRecordInfoByOrderId.htm",type:"POST",data:{regtOrdId:t},success:function(e){e.code?promptUtil.alert({content:e.message,type:"alert"}):(e.remark&&promptUtil.alert({content:"备注信息："+e.remark,type:"alert"}),$('[data-role="order-popup"]').removeClass("none"),l.render(e))}})},bindEvt:function(){$('[data-role="btnbox"]').on("tap",function(e){return $(e.target).closest('[data-role="again"]').length?1==a?(location.href="/wechat/html/doctor/home/?"+$(e.target).data("href"),!1):(location.href="/wechat/html/hospital/office/home/?"+$(e.target).data("href"),!1):($(e.target).closest('[data-role="cancel"]').length&&($('[data-role="cancle_popup"]').removeClass("none"),$("#fade").show()),$('[data-role="sureBtn"]').on("tap",function(){$('[data-role="cancle_popup"]').addClass("none"),$("#fade").hide(),l.orderCancel()}),$('[data-role="cancerBtn"]').on("click",function(){$('[data-role="cancle_popup"]').addClass("none"),$("#fade").hide()}),void($(e.target).closest('[data-role="gopay"]').length&&n&&l.orderPay()))})},orderCancel:function(){return!!r&&(r=!1,$('[data-role="cancle-doing"]').removeClass("none"),void $.ajax({url:"/order/cancleOrder.htm",type:"POST",data:{regtOrdId:t},timeout:3e4,success:function(e){e.code?promptUtil.alert({content:e.message,type:"alert"}):($('[data-role="cancle-over"]').removeClass("none"),setTimeout(function(){$('[data-role="cancle-over"]').addClass("none")},3e3),location.reload())},complete:function(){$('[data-role="cancle-doing"]').addClass("none"),r=!0}}))},orderPay:function(){return!!o&&(o=!1,$.ajax({url:"/order/pay.htm",type:"POST",data:{regtOrdId:t},success:function(e){e.code?promptUtil.alert({content:e.message,type:"alert"}):location.href=e.returnUrl},complete:function(){o=!0}}),!1)}};return{init:function(){l.fetchData(),l.bindEvt()}}}();r.init()},{}]},{},[1]);