!function t(a,e,r){function n(i,c){if(!e[i]){if(!a[i]){var d="function"==typeof require&&require;if(!c&&d)return d(i,!0);if(o)return o(i,!0);throw new Error("Cannot find module '"+i+"'")}var l=e[i]={exports:{}};a[i][0].call(l.exports,function(t){var e=a[i][1][t];return n(e?e:t)},l,l.exports,t,a,e,r)}return e[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)n(r[i]);return n}({1:[function(t,a,e){!function(){var t=TaoGu.APP.Utility,a=!0,e=t.Network.queryString("patientId"),r=function(){var r={renderPage:function(a){if($('[data-role="careName"]').html("当前用户："+(t.Network.queryString("careName")||"")),a.treatcardlist){var e=[];$.each(a.treatcardlist,function(t,a){e.push(['<li data-role="medicalLi">',"<h4>"+a.hospName+"</h4>","<p><span>诊疗卡号：</span>"+a.pCardNo,1==a.pCardState?'<i class="normal">正常</i>':'<i class="abnormal">非正常</i>',"</p>",'<a href="javascript:;" data-role="cancelBtn" data-num="'+t+'" data-memberId="'+a.tmPId+'" data-hospId="'+a.hospId+'">解除</a>',"</li>"].join(""))}),$('[data-role="medical_card_list"]').html(e.join(""))}},queryHospitalsNoCard:function(t){$.ajax({url:"/treatcard/queryHospitalsNoCard.htm ",type:"POST",data:{memberId:e},success:function(a){t(a)}})},cancelCard:function(t){if(!a)return!1;a=!1;var e=$('[data-num="'+t+'"]').attr("data-memberId"),r=$('[data-num="'+t+'"]').attr("data-hospId");$.ajax({url:"/treatcard/deleteMemberTreateCard.htm",type:"POST",data:{memberId:e,hospId:r},success:function(a){a.code?promptUtil.alert({content:json.message,type:"alert"}):($('[data-role="medicalLi"]').eq(t).remove(),promptUtil.toast("解除绑定成功！"),this.fetchPage())}.bind(this),complete:function(){a=!0}})},fetchPage:function(){$.ajax({url:"/treatcard/queryTreatCards.htm",type:"POST",success:function(t){t.code?1500==t.code?$("body").html(['<div class="no_result">','<img src="/wechat/images/no_screen.png" alt="您还没有绑定任何诊疗卡" />',"</div>",'<div class="no_result_p">您还没有绑定任何诊疗卡</div>','<section class="but_div2">','<input type="button" data-role="addCardBtn" value="添加诊疗卡" />',"</section>"].join("")):promptUtil.alert({content:t.message,type:"alert"}):r.renderPage(t)}})}};return{init:function(){r.fetchPage(),this.bindEve()},bindEve:function(){$("body").on("tap",'[data-role="addCardBtn"]',function(){r.queryHospitalsNoCard(function(t){t.code?promptUtil.alert({content:"已添加完所有医院",type:"alert"}):location.href="/wechat/html/pCard/hospitalList/?patientId="+e+"&backto="+encodeURIComponent(location.href)})}),$('[data-role="medical_card_list"]').on("tap",'[data-role="cancelBtn"]',function(){var t=this;promptUtil.alert({type:"confirm",confirm:"确认",content:"确认要解绑此诊疗卡？",confirmFunc:function(){r.cancelCard($(t).attr("data-num"))}})})}}};r().init()}()},{}]},{},[1]);